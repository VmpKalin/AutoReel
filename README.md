# üé¨ Video Processing Pipeline

–ü–æ–≤–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è –æ–±—Ä–æ–±–∫–∏ –≤—ñ–¥–µ–æ: –∞—É–¥—ñ–æ ‚Üí –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∑–≤—É–∫—É ‚Üí —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü—ñ—è ‚Üí —Å—É–±—Ç–∏—Ç—Ä–∏ ‚Üí –º–µ—Ç–∞–¥–∞–Ω—ñ.

## üìã –©–æ —Ä–æ–±–∏—Ç—å

| –ö—Ä–æ–∫ | –©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è |
|------|----------------|
| `audio` | –í–∏—Ç—è–≥—É—î –∞—É–¥—ñ–æ–¥–æ—Ä—ñ–∂–∫—É —á–µ—Ä–µ–∑ ffmpeg |
| `enhance` | –ü–æ–∫—Ä–∞—â—É—î –∑–≤—É–∫ —á–µ—Ä–µ–∑ Auphonic API |
| `merge` | –ó–∞–º—ñ–Ω—é—î –∞—É–¥—ñ–æ —É –≤—ñ–¥–µ–æ |
| `transcribe` | –¢—Ä–∞–Ω—Å–∫—Ä–∏–±—É—î —á–µ—Ä–µ–∑ WhisperX ‚Üí –∑–±–µ—Ä—ñ–≥–∞—î –ª–æ–∫–∞–ª—å–Ω–æ |
| `fix` | –í–∏–ø—Ä–∞–≤–ª—è—î –≥—Ä–∞–º–∞—Ç–∏–∫—É —Ç–∞ –ø—É–Ω–∫—Ç—É–∞—Ü—ñ—é —á–µ—Ä–µ–∑ Claude |
| `subtitles` | –ì–µ–Ω–µ—Ä—É—î .srt + .ass —Ç–∞ –Ω–∞–∫–ª–∞–¥–∞—î –Ω–∞ –≤—ñ–¥–µ–æ |
| `format` | –§–æ—Ä–º–∞—Ç—É—î –≤—ñ–¥–µ–æ (16:9, 9:16, 1:1) |
| `metadata` | Claude –≥–µ–Ω–µ—Ä—É—î –Ω–∞–∑–≤—É, –ø—ñ–¥–ø–∏—Å, —Ö–µ—à—Ç–µ–≥–∏ –¥–ª—è Instagram + TikTok |

---

## ‚ö° –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è ffmpeg

```bash
sudo apt install ffmpeg          # Ubuntu/Debian
brew install ffmpeg              # macOS
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Python venv

```bash
# –°—Ç–≤–æ—Ä—é—î–º–æ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
python3 -m venv venv

# –ê–∫—Ç–∏–≤—É—î–º–æ
source venv/bin/activate         # macOS / Linux
venv\Scripts\activate            # Windows

# –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install -r requirements.txt
```

> ‚ö†Ô∏è –ó–∞–≤–∂–¥–∏ –∞–∫—Ç–∏–≤—É–π venv –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º: `source venv/bin/activate`

### 3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```bash
cp .env.example .env
# –í—ñ–¥–∫—Ä–∏–π .env —Ç–∞ –∑–∞–ø–æ–≤–Ω–∏ API –∫–ª—é—á—ñ
```

### 4. –ó–∞–ø—É—Å–∫

```bash
# –ü–æ–≤–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω
python pipeline.py my_video.mp4

# –í–∫–∞–∑–∞—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –≤–∏–≤–æ–¥—É
python pipeline.py my_video.mp4 -o ./results

# –¢—ñ–ª—å–∫–∏ –ø–µ–≤–Ω—ñ –∫—Ä–æ–∫–∏
python pipeline.py my_video.mp4 --steps transcribe fix subtitles

# –¢—ñ–ª—å–∫–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü—ñ—è –±–µ–∑ —Ä–µ—à—Ç–∏
python pipeline.py my_video.mp4 --steps audio transcribe

# –ë–µ–∑ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∑–≤—É–∫—É (—è–∫—â–æ –Ω–µ–º–∞—î Auphonic)
python pipeline.py my_video.mp4 --steps audio merge transcribe fix subtitles format metadata
```

---

## üîë API –∫–ª—é—á—ñ

| –°–µ—Ä–≤—ñ—Å | –î–µ –≤–∑—è—Ç–∏ | –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ? |
|--------|----------|--------------|
| **Auphonic** | https://auphonic.com ‚Üí Account ‚Üí API | 2 –≥–æ–¥/–º—ñ—Å—è—Ü—å |
| **Anthropic** | https://console.anthropic.com ‚Üí API Keys | –ü–ª–∞—Ç–Ω–∏–π (~$0.01/–≤—ñ–¥–µ–æ) |

> WhisperX ‚Äî –ø–æ–≤–Ω—ñ—Å—Ç—é –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π, –∞–ª–µ –ø–æ—Ç—Ä–µ–±—É—î Python + (–±–∞–∂–∞–Ω–æ GPU)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∏–≤–æ–¥—É

```
output/
‚îú‚îÄ‚îÄ audio_original.wav        # –í–∏—Ç—è–≥–Ω—É—Ç–µ –∞—É–¥—ñ–æ
‚îú‚îÄ‚îÄ audio_enhanced.wav        # –ü–æ–∫—Ä–∞—â–µ–Ω–µ –∞—É–¥—ñ–æ (Auphonic)
‚îú‚îÄ‚îÄ video_enhanced.mp4        # –í—ñ–¥–µ–æ –∑ –Ω–æ–≤–∏–º –∑–≤—É–∫–æ–º
‚îú‚îÄ‚îÄ transcript_raw.json       # –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç –∑ —Ç–∞–π–º-–∫–æ–¥–∞–º–∏ (JSON)
‚îú‚îÄ‚îÄ transcript.txt            # –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç –∑ —Ç–∞–π–º-–∫–æ–¥–∞–º–∏ (—á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π)
‚îú‚îÄ‚îÄ transcript_fixed.json     # –í–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç (JSON)
‚îú‚îÄ‚îÄ transcript_fixed.txt      # –í–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç (—á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π)
‚îú‚îÄ‚îÄ subtitles.srt             # –°—É–±—Ç–∏—Ç—Ä–∏ SRT
‚îú‚îÄ‚îÄ subtitles.ass             # –°—É–±—Ç–∏—Ç—Ä–∏ ASS (—Å—Ç–∏–ª—ñ–∑–æ–≤–∞–Ω—ñ)
‚îú‚îÄ‚îÄ video_subtitled.mp4       # –í—ñ–¥–µ–æ –∑ —Å—É–±—Ç–∏—Ç—Ä–∞–º–∏
‚îú‚îÄ‚îÄ video_formatted.mp4       # –í—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–µ –≤—ñ–¥–µ–æ
‚îú‚îÄ‚îÄ metadata.json             # –ù–∞–∑–≤–∞, –ø—ñ–¥–ø–∏—Å–∏, —Ö–µ—à—Ç–µ–≥–∏
‚îî‚îÄ‚îÄ pipeline.log              # –õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Å—É–±—Ç–∏—Ç—Ä—ñ–≤ (.env)

```env
SUBTITLE_FONT=Arial
SUBTITLE_FONT_SIZE=18
SUBTITLE_COLOR=&H00FFFFFF          # –ë—ñ–ª–∏–π
SUBTITLE_OUTLINE_COLOR=&H00000000  # –ß–æ—Ä–Ω–∞ –æ–±–≤–æ–¥–∫–∞
SUBTITLE_OUTLINE_SIZE=2
SUBTITLE_POSITION=bottom           # bottom / top / center
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Ñ–æ—Ä–º–∞—Ç—É –≤—ñ–¥–µ–æ (.env)

```env
OUTPUT_FORMAT=9:16     # 16:9 / 9:16 / 1:1 / 4:5 / original
ADD_PADDING=true       # true = —á–æ—Ä–Ω—ñ –ø–æ–ª—è, false = crop
PADDING_COLOR=black
```

---

## üêõ –ß–∞—Å—Ç—ñ –ø—Ä–æ–±–ª–µ–º–∏

**venv –Ω–µ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ:**
```bash
# –ó–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è–π —â–æ venv –∞–∫—Ç–∏–≤–Ω–∏–π (–º–∞—î –±—É—Ç–∏ (venv) –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ä—è–¥–∫–∞)
source venv/bin/activate
```

**ffmpeg –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ:**
```bash
which ffmpeg   # –ø–µ—Ä–µ–≤—ñ—Ä —á–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
```

**WhisperX –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è:**
```bash
pip install torch
pip install whisperx
```

**WhisperX –¥—É–∂–µ –ø–æ–≤—ñ–ª—å–Ω–æ –Ω–∞ CPU:**
```env
# –£ .env –∑–º—ñ–Ω–∏—Ç–∏ –º–æ–¥–µ–ª—å –Ω–∞ –º–µ–Ω—à—É
WHISPER_MODEL=base    # –∞–±–æ small, medium
```

**–°—É–±—Ç–∏—Ç—Ä–∏ –Ω–µ —Ä–µ–Ω–¥–µ—Ä—è—Ç—å—Å—è:**
```bash
fc-list | grep Arial   # –ø–µ—Ä–µ–≤—ñ—Ä –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —à—Ä–∏—Ñ—Ç—É
# –ê–±–æ –∑–º—ñ–Ω–∏—Ç–∏ —É .env:
SUBTITLE_FONT=DejaVu Sans
```

**Auphonic –ø–æ–≤–µ—Ä—Ç–∞—î 401:**
- –ü–µ—Ä–µ–≤—ñ—Ä —â–æ —Å–∫–æ–ø—ñ—é–≤–∞–≤ API –∫–ª—é—á (–Ω–µ –ª–æ–≥—ñ–Ω/–ø–∞—Ä–æ–ª—å) —É AUPHONIC_API_KEY